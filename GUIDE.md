# Dify知识库管理插件使用指南

## 简介

Dify知识库管理插件是一个用于管理Dify知识库的综合工具。它支持创建知识库、上传文本内容以及从知识库检索信息，提供简单的界面来配置各种操作参数。

## 安装前准备

在安装和使用此插件前，您需要：

1. 拥有Dify平台账号
2. 获取知识库API Key

## 安装步骤

1. 在Dify平台中，点击右上角的"插件"按钮
2. 选择"本地上传"选项
3. 上传插件文件（.difypkg格式）
4. 完成安装后，您需要配置API Key才能使用插件

## 配置API Key

1. 在插件列表中找到"Dify知识库管理"插件
2. 点击"配置"按钮
3. 在弹出的窗口中输入您的知识库API Key
4. 点击"保存"按钮完成配置

## 如何获取知识库API Key

1. 登录Dify平台
2. 导航到知识库页面
3. 从左侧导航切换到**API访问**页面
4. 在**API Keys**部分管理访问凭证
5. 如果没有API Key，点击"创建"按钮生成一个新的API Key

## 如何获取知识库ID

知识库ID可以从知识库URL获取，例如：
`https://app.dify.ai/datasets/12345678-1234-1234-1234-123456789012`
其中`12345678-1234-1234-1234-123456789012`就是知识库ID。

## 使用方法

### 上传功能

#### 在Agent应用中使用

1. 创建或编辑一个Agent应用
2. 在应用编排页面底部找到"工具"选项
3. 选择"知识库上传"工具
4. 配置工具参数：
   - 知识库名称：要创建的知识库名称
   - 描述：知识库的描述（可选）
   - 文档名称：要创建的文档名称
   - 文本内容：要上传的文本内容
   - 权限：选择知识库权限（仅自己或公开可读）
   - 索引技术：选择高质量(high_quality)或经济(economy)模式
5. 保存配置

#### 在Chatflow/Workflow应用中使用

1. 在工作流编排画布中，点击节点末尾的"+"号
2. 选择"知识库上传"工具
3. 将其连接到上游节点
4. 配置工具参数
5. 保存配置

### 检索功能

#### 在Agent应用中使用

1. 创建或编辑一个Agent应用
2. 在应用编排页面底部找到"工具"选项
3. 选择"知识库检索"工具
4. 配置工具参数：
   - 知识库ID：要检索的知识库ID
   - 查询内容：在知识库中搜索的查询内容
   - 搜索方法：选择搜索方法（关键词检索、语义检索、全文检索或混合检索）
   - 启用重排序：是否启用搜索结果重排序
   - 结果数量：返回的结果数量
   - 启用分数阈值：是否启用分数阈值过滤
   - 分数阈值：结果的最小分数阈值
5. 保存配置

#### 在Chatflow/Workflow应用中使用

1. 在工作流编排画布中，点击节点末尾的"+"号
2. 选择"知识库检索"工具
3. 将其连接到上游节点
4. 配置工具参数
5. 保存配置

## 上传功能参数说明

- **知识库名称**（必填）：要创建的知识库名称
- **描述**（可选）：知识库的描述
- **文档名称**（必填）：要创建的文档名称
- **文本内容**（必填）：要上传的文本内容
- **权限**（必填）：知识库的权限设置，可选值：
  - `only_me`：仅自己可见，只有创建者可以访问
  - `publicly_readable`：公开可读，所有人可以读取
- **索引技术**（必填）：选择索引技术，可选值：
  - `high_quality`：高质量模式，提供更准确的检索结果，但处理时间较长
  - `economy`：经济模式，处理速度较快，但检索准确性可能略低

## 检索功能参数说明

- **知识库ID**（必填）：要检索的知识库ID
- **查询内容**（必填）：在知识库中搜索的查询内容
- **搜索方法**（可选，默认为语义检索）：用于搜索知识库的方法，可选值：
  - `keyword_search`：关键词检索，基于关键词匹配
  - `semantic_search`：语义检索，基于语义理解
  - `full_text_search`：全文检索，搜索整个文本内容
  - `hybrid_search`：混合检索，结合关键词和语义检索
- **启用重排序**（可选，默认为否）：是否启用搜索结果重排序
- **结果数量**（可选，默认为3）：返回的结果数量
- **启用分数阈值**（可选，默认为否）：是否启用分数阈值过滤
- **分数阈值**（可选，默认为0.5）：结果的最小分数阈值，范围0-1

## 上传工作流程

1. 创建新的知识库：插件会根据提供的名称和描述创建一个新的知识库
2. 创建文档：在知识库中创建一个空文档
3. 上传文本内容：将文本内容上传到创建的文档中
4. 处理文档：Dify平台会自动处理上传的文本内容，包括文本分段和索引
5. 返回结果：插件会返回处理状态和结果

## 检索工作流程

1. 提供知识库ID和查询内容
2. 选择搜索方法和其他参数
3. 执行知识库检索
4. 返回检索结果和相关信息

## 搜索方法说明

- **关键词检索**：基于关键词匹配，适合精确查找特定术语或短语
- **语义检索**：基于语义理解，能够找到语义相关但可能不包含完全相同关键词的内容
- **全文检索**：搜索整个文本内容，适合需要在大量文本中查找信息
- **混合检索**：结合关键词和语义检索，提供更全面的搜索结果

## 常见问题

### 上传或检索失败，提示"API Key validation failed"

请检查您提供的API Key是否正确，以及是否有足够的权限访问知识库。

### 上传成功后，文档在知识库中不可见

文档上传后需要一段时间进行处理和索引。您可以在知识库页面查看文档的处理状态。

### 检索失败，提示"知识库不存在或无权访问"

请确保您提供的知识库ID是正确的，并且您的API Key有权限访问该知识库。

### 检索结果不符合预期

尝试调整搜索方法、启用重排序或调整分数阈值，以获得更符合预期的结果。

## 技术支持

如果您在使用过程中遇到任何问题，请联系插件作者或在Dify社区论坛中提问。